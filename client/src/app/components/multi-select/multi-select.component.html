<div class="dropdown" [class.show]="isOpen()" (click)="toggleDropdown()">
  <div
    role="button"
    aria-haspopup="true"
    aria-expanded="isOpen()"
    style="display: flex; justify-content: space-between; align-items: center; width: 100%"
  >
    <div class="chip-container" style="display: flex; flex-wrap: nowrap; gap: 5px">
      @for (select of selected(); track select) {
        <div class="chip bg-light">{{ select }}</div>
      }
    </div>
    <div>
      @if (isOpen()) {
        <app-chevron-up-icon />
      } @else {
        <app-chevron-down-icon />
      }
    </div>
  </div>
  <div class="dropdown-menu background-image p-2" [class.show]="isOpen()" (click)="$event.stopPropagation()">
    <div class="dropdown-search">
      <input
        type="text"
        class="form-control w-100"
        placeholder="Search..."
        [(ngModel)]="searchTerm"
        (ngModelChange)="filterOptions()"
      />
    </div>

    @for (option of filteredItems(); track option) {
      <div class="form-check">
        <input
          type="checkbox"
          class="form-check-input"
          [id]="option"
          [checked]="selected().includes(option)"
          (change)="onSelectionChange(option, $event)"
        />
        <label class="form-check-label" [for]="option">{{ option }}</label>
      </div>
    }
  </div>
</div>
